/*! angular-google-maps-native v1.3.0 | 2015-07-12 | DEMONTE Jean-Baptiste | jbdemonte@gmail.com | GPL v3 */
!function(n,e){"use strict";function t(e){var t=y.defer();return h("Geocoder").geocode(n.isString(e)?{address:e}:e,function(n,e){e===v.GeocoderStatus.OK?t.resolve(n[0].geometry.location,n):(i("geocode: "+e),t.reject())}),t.promise}function i(){console&&console.error.apply(console,arguments)}function r(n){return(n.ngShow?"("+n.ngShow+")":"")+(n.ngHide?(n.ngShow?" && ":"")+"!("+n.ngHide+")":"")||""}function o(e,t){var i=t?e:null;return e instanceof v.LatLng?i=e:n.isArray(e)?i=new v.LatLng(e[0],e[1]):n.isObject(e)&&"lat"in e&&(i=new v.LatLng(e.lat,e.lng)),i}function u(n){return 1*n}function c(e){var t,i;return!e||e instanceof v.LatLngBounds?e||null:(n.isArray(e)?2===e.length?(t=o(e[0]),i=o(e[1])):4===e.length&&(t=o([e[0],e[1]]),i=o([e[2],e[3]])):"ne"in e&&"sw"in e?(t=o(e.ne),i=o(e.sw)):"n"in e&&"e"in e&&"s"in e&&"w"in e&&(t=o([e.n,e.e]),i=o([e.s,e.w])),t&&i?new v.LatLngBounds(i,t):null)}function a(n){return n+="",n.charAt(0).toLowerCase()+n.substr(1)}function s(n){return n+="",n.charAt(0).toUpperCase()+n.substr(1)}function l(n,e){var t;return function(){return n&&(t=n.apply(e||this,arguments),n=null),t}}function f(n){return n.replace(/([a-z0-9])([A-Z])/g,"$1_$2").replace(/^[^_]+_/,"").toLowerCase()}function d(e,t,i){n.forEach(i,function(n,i){var r=i.match(/^on(ce)?[A-Z]/);r&&v.event["addListener"+(r[1]?"Once":"")](e,f(i),function(e){b(function(){t.$apply(function(){var i=t.$new(!1);i.event=e,w(n)(i)})})})})}function g(e,i,r){var o,u;return $ in i&&(u=e.$watch(i[$],function(e){o=e,e&&t(e).then(function(t){n.equals(o,e)&&r(t)})})),u}function m(e,t,i,r,u){n.forEach(r.split(" "),function(r){function c(n){i.then(function(e){e["set"+s(r)](u?u(n):n)})}var a=r.toLowerCase();a in t&&e.$watch(t[a],function(e){n.isDefined(e)&&c(e)}),u===o&&g(e,t,function(n){c(n)})})}function p(e,t,r,u,c){function a(){n.forEach(r,function(n,e){n&&(p[e]=n(p[e]))}),u(p)}function s(){var e=!0;return n.forEach(f,function(n){e=e&&p[n]}),e}function l(){s()&&(c&&n.forEach(m,function(n){n()}),a())}var f,d,m=[],p={};n.isString(r)?(f=r.split(" "),r={}):f=Object.keys(r),t.options&&(p=w(t.options)(e)),s()&&a(),c&&s()||n.forEach(f,function(u){var c=!1,a=u.toLowerCase();a in t&&(c=!0,m.push(e.$watch(t[a],function(e){n.isDefined(e)&&(p[u]=e,l())}))),r[u]===o&&(d=g(e,t,function(n){p[u]=n,l()}),d&&(c=!0,m.push(d))),c||n.isDefined(p[u])||i(u+" missing")})}var v,h,y,w,b,$="gmAddress";h=function(){var n={};return function(e){return!n.hasOwnProperty(e)&&v[e]&&(n[e]=new v[e]),n[e]}}(),n.module("GoogleMapsNative",[]).provider("gmLibrary",function(){function e(){var e=u.url,t=e.indexOf("?");return-1===t?e+="?":t===e.length-1&&(e+="&"),n.forEach(u,function(n,t){-1===o.indexOf(t)&&(e+=t+"="+n+"&")}),u.libraries.length&&(e+="libraries="+u.libraries.join(",")),e}function t(n,t){var o,c=u.callback;return r||(r=!0,i=y.defer(),t[c]=function(){if(delete t[c],v=t.google.maps,!v)throw"google.maps library not found";i.resolve()},o=n[0].createElement("script"),o.type="text/javascript",o.src=e(),n.find("body").append(o)),i.promise}var i,r=!1,o=["url","libraries"],u={url:"https://maps.googleapis.com/maps/api/js",v:3,libraries:[],language:"en",sensor:"false",callback:"__mapLibraryLoaded"};this.configure=function(e){n.extend(u,e)},this.$get=["$document","$window","$rootScope","$q","$parse","$timeout",function(n,e,i,r,o,u){return y=r,w=o,b=u,{populate:function(n){n.google=google,i.google=google},load:function(){return t(n,e)}}}]}).directive("gmMap",["gmLibrary",function(t){return{restrict:"E",scope:!0,controller:["$scope","$element","$attrs",function(i,c,a){function s(n){var e=r(a);e?i.$watch(e,function(e){e&&(f?b(function(){v.event.trigger(f,"resize")}):g(n))}):g(n)}var f,g,h=this,$=y.defer(),L=n.element(document.createElement("DIV"));c.css("position")||c.css("position","relative"),L.css({position:"absolute",top:0,right:0,bottom:0,left:0}),c.append(L),i.$on("$destroy",function(){f?(f=e,delete i.map):$.reject()}),g=l(function(n){b(function(){f=new v.Map(L[0],n),i.map=f,d(f,i,a),$.resolve(f)},100)}),h.init=function(){t.load().then(function(){t.populate(i),p(i,a,{center:o,zoom:u},function(n){s(n),m(i,a,h,"center",o),m(i,a,h,"mapTypeId"),m(i,a,h,"heading tilt zoom",u)},!0)}),a.gmThen&&h.then(function(){w(a.gmThen)(i.$new(!1))})},h.then=function(n){$.promise.then(n)},h.get=function(){return f}}],link:function(n,e,t,i){i.init()}}}]).service("gmOverlayBuilder",function(){return{builder:function(t){var i=[t.directive||"gm"+s(t.cls.toLowerCase())];return n.isArray(t.require)?Array.prototype.push.apply(i,t.require):t.require&&n.isString(t.require)&&i.push(t.require),i.push("^gmMap"),{restrict:"E",scope:!0,require:i,controller:["$scope","$element","$attrs",function(n,i,o){function u(e){var u=r(o),a=f.get();u?n.$watch(u,function(r){c?t.visibility?t.visibility(n,i,o,g,r):c.setMap(r?a:null):(s(e,a,r),t.visibility&&t.visibility(n,i,o,g,r))}):s(e,a,!0)}var c,s,f,g,h=t.name||a(t.cls),b=this,$=y.defer();n.$on("$destroy",function(){c?(t.destroy?t.destroy(n,i,o,c):c.setMap(e),c=e,delete n[h]):$.reject()}),s=l(function(e,r,u){var a=t.opts?e.opts||{}:e;!u&&a.map&&delete a.map,c=t.instantiate?t.instantiate(n,i,o,e):new v[t.cls](e),u&&!a.map&&c.setMap&&c.setMap(r),n[h]=c,d(c,n,o),$.resolve(c)}),b.init=l(function(e){g=e,f=g[g.length-1],f.then(function(e){var r={},c={};t.create&&(o.options&&(c=w(o.options)(n),t.main&&c[t.main.name]&&(c[t.main.name]=t.main.cast(c[t.main.name]))),t.create(n,i,o,g,c,u))||(r[t.main.name]=t.main.cast,p(n,o,r,function(i){t.opts?(i.opts=i.opts||{},i.opts.map=e):i.map=e,u(i),m(n,o,b,t.main.name,t.main.cast)},!0))}),o.gmThen&&b.then(function(){w(o.gmThen)(n.$new(!1))})}),b.then=function(n){$.promise.then(n)},b.get=function(){return c}}],link:function(n,e,t,i){i[0].init(i)}}}}}).directive("gmMarker",["gmOverlayBuilder",function(n){return n.builder({cls:"Marker",main:{name:"position",cast:o}})}]).directive("gmCircle",["gmOverlayBuilder",function(n){return n.builder({cls:"Circle",main:{name:"center",cast:o}})}]).directive("gmRectangle",["gmOverlayBuilder",function(n){return n.builder({cls:"Rectangle",main:{name:"bounds",cast:c}})}]).directive("gmInfowindow",["gmOverlayBuilder",function(n){return n.builder({require:"^?gmMarker",name:"infowindow",cls:"InfoWindow",main:{name:"position",cast:o},destroy:function(n,e,t,i){i.close()},create:function(n,e,t,i,r,u){var c=i[0],a=i[1],s=i[2],l=function(n){u(n),t.ngShow||t.ngHide||c.then(function(n){n.open(s.get(),a?a.get():null)})};return a?a.then(function(){l(r)}):p(n,t,{position:o},function(e){l(e),m(n,t,i[0],"position",o)},!0),!0},visibility:function(n,e,t,i,r){var o=i[0].get(),u=i[1],c=i[2];return r?void o.open(c.get(),u?u.get():null):o.close()}})}]).directive("gmDirections",function(){return{restrict:"E",scope:!0,require:["gmDirections","^gmMap"],controller:["$scope",function(n){var e=y.defer(),t={result:null,status:""};this._run=function(i){i.origin=o(i.origin,!0),i.destination=o(i.destination,!0),h("DirectionsService").route(i,function(i,r){t.result=i,t.status=r,n.$apply(function(){n.directions={result:i,status:r}}),e.resolve(t)})},this.then=function(n){e.promise.then(n)},this.get=function(){return t}}],link:function(n,e,t,i){var r=i[0],o=i[1];o.then(function(){p(n,t,"origin destination travelMode",function(n){r._run(n)})})}}}).directive("gmRenderer",["gmOverlayBuilder",function(n){return n.builder({directive:"gmRenderer",name:"renderer",cls:"DirectionsRenderer",require:"^gmDirections",create:function(n,e,t,i,r,o){var u=i[0],c=i[1],a=i[2];return c.then(function(e){r.map=a.get(),r.directions=e.result,n.$watch("directions",function(n){u.get().setDirections(n.result)}),o(r)}),!0}})}]).directive("gmPolyline",["gmOverlayBuilder",function(e){return e.builder({cls:"Polyline",main:{name:"path",cast:function(e){return n.forEach(e,function(n,t){e[t]=o(n)}),e}}})}]).directive("gmPolygon",["gmOverlayBuilder",function(e){return e.builder({cls:"Polygon",main:{name:"paths",cast:function(e){return n.forEach(e,function(n,t){e[t]=o(n)}),e}}})}]).directive("gmGroundoverlay",["gmOverlayBuilder",function(n){return n.builder({cls:"GroundOverlay",opts:!0,instantiate:function(n,e,t,i){return new v.GroundOverlay(i.url,i.bounds,i.opts)},create:function(n,e,t,i,r,o){return i[1].then(function(){p(n,t,"url bounds",function(n){n.bounds=c(n.bounds),o(n)},!0)}),!0}})}]).directive("gmKmllayer",["gmOverlayBuilder",function(n){return n.builder({cls:"KmlLayer",opts:!0,main:{name:"url"},instantiate:function(n,e,t,i){return new v.KmlLayer(i.url,i.opts)}})}]).service("gmLayerBuilder",["gmOverlayBuilder",function(e){return{builder:function(t){return e.builder(n.extend({create:function(n,e,t,i,r,o){return t.ngShow||t.ngHide||i[0].then(function(n){n.setMap(i[1].get())}),o(r),!0}},t))}}}]).directive("gmTrafficlayer",["gmLayerBuilder",function(n){return n.builder({cls:"TrafficLayer"})}]).directive("gmBicyclinglayer",["gmLayerBuilder",function(n){return n.builder({cls:"BicyclingLayer"})}]).directive("gmTransitlayer",["gmLayerBuilder",function(n){return n.builder({cls:"TransitLayer"})}]).directive("gmStreetviewpanorama",["gmLibrary",function(n){return{restrict:"E",scope:!0,controller:["$scope","$element","$attrs",function(t,i,c){function a(n){var e=r(c);e?t.$watch(e,function(e){e&&(s?b(function(){v.event.trigger(s,"resize")}):f(n))}):f(n)}var s,f,g=this,h=y.defer();t.$on("$destroy",function(){s?(s=e,delete t.streetViewPanorama):h.reject()}),f=l(function(n){b(function(){s=new v.StreetViewPanorama(i[0],n),t.streetViewPanorama=s,d(s,t,c),h.resolve(s)},100)}),g.init=l(function(){n.load().then(function(){n.populate(t),p(t,c,{position:o},function(n){a(n),m(t,c,g,"position",o),m(t,c,g,"pov"),m(t,c,g,"zoom",u)},!0)}),c.gmThen&&g.then(function(){w(c.gmThen)(t.$new(!1))})}),g.then=function(n){h.promise.then(n)},g.get=function(){return s}}],link:function(n,e,t,i){i.init()}}}])}(angular);